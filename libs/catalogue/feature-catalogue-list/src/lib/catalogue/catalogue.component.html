@let hasMorePages =
  state.products() && (state.totalProducts() || 0) > state.products()!.length;

<mat-sidenav-container class="catalogue-container">
  <mat-sidenav mode="side" opened class="catalogue-sidenav">
    <div class="sidenav-content">
      <h3>Filters</h3>
      <lib-product-filters (filtersChanged)="searchProducts($event)" />
    </div>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content class="catalogue-content">
    <div class="content-wrapper">
      <!-- Header Section -->
      <header class="catalogue-header">
        <h1>Plant Catalogue</h1>
        <p class="catalogue-subtitle">
          Discover our beautiful collection of indoor plants
        </p>
      </header>

      <!-- Search Section -->
      <section class="search-section">
        <lib-plant-filter
          [searchTerm]="state.searchTerm()"
          (search)="onSearchChange($event)"
        />
        <!-- <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search plants</mat-label>
          <input
            matInput
            type="text"
            [value]="state.searchTerm()"
            (input)="onSearchChange($any($event.target).value)"
            placeholder="Search by plant name..."
            aria-label="Search for plants by name"
          />
        </mat-form-field> -->
      </section>

      <!-- Pills for Active Filters -->
      <lib-search-pills />

      <!-- Results Summary -->
      <div class="results-summary">
        <p>
          Showing {{ state.products().length }} of
          {{ state.totalProducts() || 0 }}
          plants
        </p>
      </div>

      <!-- Products Grid -->
      <div class="products-grid">
        @for (product of productsWithFavourites()!; track product.id) {
          <lib-ui-product-card
            [product]="product"
            (toggleFavorite)="onToggleFavorite($event)"
          />
        } @empty {
          <div class="no-results">
            <p>No plants found matching "{{ state.searchTerm() }}"</p>
            <button
              mat-raised-button
              color="primary"
              (click)="onSearchChange('')"
            >
              Clear Search
            </button>
          </div>
        }
      </div>

      @if (hasMorePages) {
        <button mat-raised-button color="primary" (click)="onLoadMore()">
          Load More
        </button>
      }
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
